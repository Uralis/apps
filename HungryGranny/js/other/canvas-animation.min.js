class ConfettiAnimation{constructor(canvasId,maxParticles=150){this.canvas=document.getElementById(canvasId);this.context=this.canvas.getContext("2d");this.W=innerWidth;this.H=innerHeight;this.maxParticles=maxParticles;this.particles=[];this.animationFrameId=null;this.mode="victory";this.victoryColors=["DodgerBlue","OliveDrab","Gold","Pink","SlateBlue","LightBlue","Violet","PaleGreen","SteelBlue","SandyBrown","Chocolate","Crimson"];this.defeatColors=["DarkGray","DimGray","DarkSlateGray","Maroon","DarkRed","MidnightBlue"];this.init();this.setupEventListeners()}random(min,max){return Math.floor(Math.random()*(max-min+1)+min)}createParticle(){if(this.mode==="victory"){return{x:Math.random()*this.W,y:Math.random()*this.H-this.H,r:this.random(11,33),d:Math.random()*this.maxParticles+11,color:this.victoryColors[this.random(0,this.victoryColors.length-1)],tilt:this.random(-11,22),tiltAngle:0,tiltAngleIncremental:Math.random()*.07+.05}}else{return{x:Math.random()*this.W,y:Math.random()*this.H-this.H,r:this.random(10,25),speed:this.random(2,5),color:this.defeatColors[this.random(0,this.defeatColors.length-1)],opacity:1}}}drawParticle(particle,index){const ctx=this.context;if(this.mode==="victory"){ctx.beginPath();ctx.lineWidth=particle.r/2;ctx.strokeStyle=particle.color;ctx.moveTo(particle.x+particle.tilt+particle.r/3,particle.y);ctx.lineTo(particle.x+particle.tilt,particle.y+particle.tilt+particle.r/5);ctx.stroke()}else{ctx.fillStyle=particle.color;ctx.globalAlpha=particle.opacity;ctx.beginPath();ctx.arc(particle.x,particle.y,particle.r,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1}}updateParticles(){this.particles.forEach((particle,i)=>{if(this.mode==="victory"){particle.tiltAngle+=particle.tiltAngleIncremental;particle.y+=(Math.cos(particle.d)+3+particle.r/2)/2;particle.tilt=Math.sin(particle.tiltAngle-i/3)*15;if(particle.y>this.H){this.particles[i]=this.createParticle()}}else{particle.y+=particle.speed;particle.opacity-=.005;particle.r*=.99;if(particle.y>this.H||particle.opacity<=0){this.particles[i]=this.createParticle()}}})}draw(){if(!this.animationFrameId)return;this.animationFrameId=requestAnimationFrame(()=>this.draw());this.context.clearRect(0,0,this.W,this.H);this.updateParticles();this.particles.forEach((p,i)=>this.drawParticle(p,i))}start(mode){this.mode=mode;this.particles.length=0;for(let i=0;i<this.maxParticles;i++){this.particles.push(this.createParticle())}if(!this.animationFrameId){this.animationFrameId=requestAnimationFrame(()=>this.draw())}}stop(){cancelAnimationFrame(this.animationFrameId);this.animationFrameId=null;this.context.clearRect(0,0,this.W,this.H);this.particles.length=0}setupEventListeners(){addEventListener("resize",()=>{this.W=innerWidth;this.H=innerHeight;this.canvas.width=this.W;this.canvas.height=this.H})}init(){this.canvas.width=this.W;this.canvas.height=this.H}}